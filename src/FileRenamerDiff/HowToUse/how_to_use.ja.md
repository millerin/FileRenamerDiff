% How To Use
% soi
% 2021/02/08

[View Online](https://github.com/soi013/FileRenamerDiff/blob/master/src/FileRenamerDiff/HowToUse/how_to_use.ja.md)

# クイックマニュアル

1. 対象ファイルの指定: ファイルリストへファイルをドラッグ＆ドロップするか、特定のディレクトリから<kbd>ファイル探索実行</kbd>することができます。   
1. リネームパターンの設定: <kbd>設定</kbd> から削除/置換パターンを設定します。
1. 名前の変更を確認: <kbd>プレビュー</kbd> を実行して名前の変更を確認します。
1. リネームを実行: <kbd>リネーム保存</kbd> を実行して、実際のファイル名を変更します。

# 対象ファイル指定

リネーム対象となるファイルを "ファイル探索" か "直接指定" 2つの方法で指定できます。

ターゲットファイルリストからファイルを除くには行内左端のボタンからできます。左上のボタンでファイルリストを空にすることもできます。

## ファイル探索

任意のフォルダから、その中にあるファイルを探索して、対象ファイルリストに追加します。

ファイル探索は以下の3つの方法があります。

- 左上のフォルダアイコンからダイアログで選択
- 左上のフォルダパスにフォルダをドラッグ
- 左上のフォルダパスに直接入力して、 <kbd>ファイル探索実行</kbd> 

ファイル探索の条件は <kbd>設定</kbd> > <kbd>ファイル探索</kbd> から指定できます。

## 直接指定

リネームしたいファイルを直接指定します。

直接指定は以下の2つの方法があります。

- 上の <kbd>ファイル追加</kbd> からダイアログで選択
- ファイルリストにファイルをドラッグ

# リネーム設定

ファイルリネームの条件を指定します。

条件の実行順序は "削除" → "置換" の順番です。 "置換" の後に "削除" をしたい場合は、 <kbd>置換パターン</kbd> で<kbd>置換後</kbd>を空にすれば"削除"と同じです。

## 削除する文字

削除する文字を指定します。

 <kbd>追加</kbd> で新しい行が追加されます。行の削除は行内の右側のボタンでできます。順番の入れ替えは行内の左端をつかんでドラッグです。

右下のボタンから、 "Common Pattern" が表示され選べます。

正規表現にチェックが入っていると、正規表現を使用して削除する文字を指定できます。

### 正規表現

このソフトウェアの正規表現は"Microsoft .NET"の正規表現を使用しています。代表的なものを以下に並べます。より詳しい説明は以下のリンクを参照して下さい。

[Regex Quick Reference - Microsoft Docs ](https://docs.microsoft.com/dotnet/standard/base-types/regular-expression-language-quick-reference#character-escapes)

| 正規表現          | 説明                                                     | pattern | Input          | Output             |
| ------------------ | ---------------------------------------------------------- | ------- | -------------- | ------------------ |
| `[`ch_group`]`       | *ch_group* 内の任意の 1 文字 | [ae]    | Gr**a**y,S**ea**,Gr**ee**n | Gry,S,Grn |
| `[`first`-`last`]` | 文字範囲:*first* から *last* までの範囲にある任意の 1 文字 | [A-Z]   | **R**ocky4 | ocky4           |
| `.`                | ワイルドカード:任意の 1 文字 | a.e     | w**ate**r      | wr                 |
| `\w`                 | 単語に使用される任意の文字 | \\w | **A**.**a** **あ**~**ä**- | . ~- |
| `\s`               | 空白文字              | \\s     | A B　C | ABC    |
| `\d`               | 数字                            | \\d     | Rocky**4** | Rocky |
| `^`              | ファイル名の先頭 | ^r    | **r**ear rock | ear rock |
| `$`              | ファイル名の末尾 | r$     | rock rea**r** | rock rea |
| `*`            | 直前の要素と 0 回以上一致 | o*r | d**oor**,**or**,o,l**r** | d,,o,l |
| `+`              | 直前の要素と 1 回以上一致 | o+r | d**oor**,**or**,o,lr | d,,o,lr |
| `?`              | 直前の要素と 0 回または 1 回一致 | o?r  | do**or**,**or**,o,l**r** | do,,o,l |
| `{`n`}` | 直前の要素とちょうど *n* 回一致 | [or]{2} | d**oo**r,**or**,o,lr | dr,,o,lr |
| `\`escape | `.`や`*`などのエスケープ文字を通常の文字として認識する | \\d\\.\\d | 1\_**2\.3**\_45           | 1__45    |

## 置換パターン

置換前と置換後のパターンを指定します。

 <kbd>追加</kbd> で新しい行が追加されます。行の削除は行内の右側のボタンでできます。順番の入れ替えは行内の左端をつかんでドラッグです。

右下のボタンから、 "Common Pattern" が表示され選べます。

<kbd>正規表現</kbd>にチェックが入っていると、正規表現を使用して置換パターンを指定できます。

### 正規表現

置換前の正規表現は <kbd>削除する文字</kbd> と同じです。

置換後に使える正規表現もあります。代表的なものを以下に並べます。より詳しい説明は以下のリンクを参照して下さい。

[Substitutions In Regular Expressions - Microsoft Docs ](https://docs.microsoft.com/dotnet/standard/base-types/substitutions-in-regular-expressions)

| 正規表現 | 説明                                                         | 置換前 | 置換後 | Input          | Output           |
| ------ | ------------------------------------------------------------ | ----------- | ------------ | -------------- | ---------------- |
| ` $0 ` | 一致した文字列全てを置換文字列に含めます | ABC         |  X$0X  | abc **ABC** AnBC | abc **XABCX** AnBC |
| ` $num ` | *num* で識別されるキャプチャ グループに一致する最後の部分文字列を置換文字列に含めます | \\d\*\(\\d{3}\) | \$1       | A**0012** 34   | A**012** 34      |

### FileRenamerDiff Original Regex

これはMicrosoft .NETの正規表現にはない、このアプリケーション独自の正規表現です。

| 正規表現 | 説明                                 | Input          | Output             |
| -------- | ------------------------------------ | -------------- | ------------------ |
| `\u`       | すべてのテキストを大文字に変換する   | l**ow** UPP P**as** | L**OW** UPP P**AS** |
| `\l`       | すべてのテキストを小文字に変換する | low **UPP** **P**as | low **upp** **p**as |
| `\h`       | すべての英数字を半角に変換する | Ha14 **Ｆｕ１７** | Ha14 **Fu17**      |
| `\f`       | すべての英数字を全角に変換する | **Ha14** Ｆｕ１７ | **Ｈａ１４** Ｆｕ１７ |
| `\f`       | すべての半角カタカナを全角に変換する | **ｱﾝﾊﾟﾝ ﾊﾞｲｷﾝ** | **アンパン バイキン** |
| `\n`       | ウムラウトをASCII英字に変換する | s**üß** **Ö**L **Ä**ra | s**uess** **OE**L **Ae**ra |

### 特殊文字追加

置換パターンの<kbd>置換後</kbd>に記号を指定することで、特殊な文字を追加できます。

| 置換後 | 説明                                 | Input                  | Output                     |
| ---- | ------------------------------------ | ---------------------- | -------------------------- |
| `$d` | 親フォルダ名を追加                     | _abc.txt               | **ParentDir**_abc.txt      |
| `$t` | 更新日時を追加                     | _abc.txt               | **2018-03-14**_abc.txt      |
| `$t<yy-MM-dd HH-mm-ss>` | 更新日時を書式指定付きで追加                     | _abc.txt               | **18-03-14 18-58-59**_abc.txt      |
| `$t<D>` | 更新日時をローカル書式で追加                     | _abc.txt               | **2018年3月14日**_abc.txt      |
| `$t<,c>` | 作成日時を追加                     | _abc.txt               | **1942-01-08**_abc.txt      |
| `$t<yy-MM-dd HH-mm-ss,c>` | 作成日時を書式指定付きで追加                     | _abc.txt               | **42-01-08 14-58-59**_abc.txt |
| `$n`                      | 連番を追加         | _a.txt<br />_b.txt<br />_c.txt | **1**_a.txt<br />**2**_b.txt<br />**3**_c.txt                        |
| `$n<0,10,000>`                      | 開始番号・ステップ数・ゼロ詰め桁数を指定して連番を追加 | _a.txt<br />_b.txt<br />_c.txt | **00**_a.txt<br />**10**_b.txt<br />**20**_c.txt                      |

### 連番専用設定ダイアログ

連番設定は複雑なので設定ダイアログがあります。

以下の設定を変更して、サンプルファイルリストで確認できます。

- 挿入場所
- 開始番号
- ステップ数
- ゼロ詰め桁数
- フォルダごとリセット
- 逆順
- 前置き文字列
- 後置き文字列

最後に<kbd>追加</kbd>で置換パターンに追加できます。




# リネーム確認

 <kbd>リネームプレビュー</kbd> でファイルのリネーム前後を確認できます。

ファイルリストの各列の説明は以下です。

| 列名             | 表示内容                                           | 機能                                                         |
| ---------------- | -------------------------------------------------- | ------------------------------------------------------------ |
| 削除ボタン       | 削除ボタン                                         | その行を削除する。ヘッダのボタンは全てのファイルを削除する。 |
| 現在のファイル名 | リネーム前のファイル名。変更部分が桃色背景になる。 |                                                              |
| 新しいファイル名 | リネーム後のファイル名。変更部分が緑色背景になる。 |                                                              |
| 変更ありマーク   | 変更があれば、チェックマークが表示される           | ヘッダのボタンでファイルリストを変更ありのみにする           |
| 重複ありマーク   | 重複があれば、重複マークが表示される               | ヘッダのボタンでファイルリストを重複ありのみにする           |
| ファイル種類マーク   | ファイルの種類をアイコンで表示       |            |
| ディレクトリ     | ファイルの所属しているディレクトリ                 | クリックするとファイルをエクスプローラーで表示する           |
| サイズ           | ファイルのサイズ                                   |                                                              |
| 更新日時         | ファイルの更新日時                                 |                                                              |
| 作成日時         | ファイルの作成日時                                 |                                                              |





# リネーム保存

<kbd>リネーム保存</kbd>で実際のファイル名を保存します。ファイルリストに重複があった場合は実行できません。

リネーム実行時にファイルの所属するディレクトリが書き換わった場合はファイルリストから除かれます。

